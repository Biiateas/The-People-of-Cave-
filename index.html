<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timeline Challenge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700&display=swap"
        rel="stylesheet">
    <style>
        * {
            font-family: 'Cairo', 'Amiri', serif;
        }

        .arabic-title {
            font-family: 'Amiri', serif;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-20px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        @keyframes pulse-glow {

            0%,
            100% {
                box-shadow: 0 4px 15px rgba(218, 165, 32, 0.3);
            }

            50% {
                box-shadow: 0 8px 30px rgba(218, 165, 32, 0.6);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }

            100% {
                background-position: 1000px 0;
            }
        }

        @keyframes celebration {

            0%,
            100% {
                transform: scale(1);
            }

            25% {
                transform: scale(1.1) rotate(-3deg);
            }

            50% {
                transform: scale(1.15);
            }

            75% {
                transform: scale(1.1) rotate(3deg);
            }
        }

        @keyframes sparkle {

            0%,
            100% {
                opacity: 0;
                transform: scale(0);
            }

            50% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .confetti {
            animation: confettiFall 3s linear forwards;
        }

        .dragging {
            opacity: 0.5;
            transform: scale(0.95);
            transition: all 0.2s ease;
        }

        .pulse-glow {
            animation: pulse-glow 2s ease-in-out infinite;
        }

        .celebration-bounce {
            animation: celebration 0.6s ease-in-out;
        }

        .shimmer-overlay {
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }

        .drop-zone-hover {
            transform: scale(1.08);
            box-shadow: 0 8px 25px rgba(218, 165, 32, 0.5);
            border-color: #FFD700 !important;
        }

        .event-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .event-card:active {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 12px 30px rgba(210, 105, 30, 0.4);
        }

        .timeline-point {
            transition: all 0.4s ease;
        }

        .timeline-point.filled {
            animation: celebration 0.5s ease-out;
        }

        .sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #FFD700;
            border-radius: 50%;
            animation: sparkle 1.5s ease-in-out infinite;
        }

        .success-overlay {
            backdrop-filter: blur(10px);
        }

        /* Mobile touch improvements */
        @media (max-width: 768px) {
            * {
                -webkit-tap-highlight-color: transparent;
            }
        }

        /* Landscape mode optimizations */
       @media (max-height: 800px) and (orientation: landscape) {
            body {
                padding: 0.5rem !important;
            }
            
            .header-section h1 {
                font-size: 1.5rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .header-section .subtitle {
                font-size: 0.875rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .header-section {
                margin-bottom: 1rem !important;
            }
            
            .timeline-container {
                padding: 1rem !important;
                margin-bottom: 1rem !important;
            }
            
            .section-title {
                font-size: 1rem !important;
                margin-bottom: 0.75rem !important;
            }
            
            #resetBtn {
                width: 2.5rem !important;
                height: 2.5rem !important;
                font-size: 1.25rem !important;
                margin-bottom: 0.5rem !important;
            }
            
            .event-card {
                height: 3rem !important;
            }
            
            .mb-8 {
                margin-bottom: 1rem !important;
            }
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-amber-50 via-orange-50 to-yellow-50 p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="header-section text-center mb-8 md:mb-12">
            <h1 class="text-3xl md:text-5xl font-bold arabic-title mb-3"
                style="background: linear-gradient(135deg, #8B4513 0%, #D2691E 50%, #DAA520 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                Ù‚ØµØ© Ø£ØµØ­Ø§Ø¨ Ø§Ù„ÙƒÙ‡Ù
            </h1>
            <p class="subtitle text-amber-800 text-base md:text-lg mb-4 md:mb-6 font-semibold px-4">Ø±ØªÙ‘Ø¨ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªØ§Ù„ÙŠØ© Ø­Ø³Ø¨ ØªØ³Ù„Ø³Ù„Ù‡Ø§ Ø§Ù„Ø²Ù…Ù†ÙŠ</p>
            <button id="resetBtn"
                class="text-xl md:text-2xl text-white w-12 h-12 md:w-14 md:h-14 rounded-full font-bold flex items-center justify-center shadow-md hover:shadow-xl transform hover:scale-110 active:scale-95 hover:rotate-180 transition-all duration-500 pulse-glow mb-6 md:mb-8 mx-auto"
                style="background: linear-gradient(135deg, #8B4513 0%, #D2691E 100%);">
                âŸ²
            </button>

            <!-- Decorative Cave Image - Hidden on mobile -->
            <div class="hidden md:block fixed bottom-4 right-4 z-10 opacity-90 hover:opacity-100 transition-opacity duration-300">
                <img src="cave-illustration-cartoon-generative-ai-free-png.png" alt="Cave decoration"
                    class="w-64 lg:w-96 h-auto drop-shadow-lg rounded-lg">
            </div>

            <!-- Success Message -->
            <div id="successMessage"
                class="hidden fixed inset-0 z-50 flex items-center justify-center success-overlay p-4"
                style="background: rgba(255, 248, 220, 0.97);">
                <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-10 text-center border-4 celebration-bounce relative overflow-hidden w-full max-w-md md:max-w-2xl"
                    style="border-color: #DAA520;">

                    <div class="absolute inset-0 shimmer-overlay pointer-events-none"></div>

                    <div class="text-4xl md:text-5xl mb-4 animate-bounce">ğŸ‘ğŸ‘ğŸ‘</div>

                    <h2 class="text-2xl md:text-3xl font-bold arabic-title mb-2" style="color: #8B4513;">
                        Ø£Ø­Ø³Ù†Øª!
                    </h2>
                    <p class="text-amber-800 text-xl md:text-2xl font-semibold">Ø¨Ø§Ø±Ùƒ Ø§Ù„Ù„Ù‡ ÙÙŠÙƒ ÙˆÙ†ÙØ¹ Ø¨Ùƒ</p>
                    
                    <button onclick="document.getElementById('resetBtn').click()"
                        class="mt-6 bg-gradient-to-r from-amber-600 to-amber-800 text-white px-6 py-3 rounded-xl font-bold text-lg transform hover:scale-105 active:scale-95 transition-all shadow-lg">
                        Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ğŸ”„
                    </button>
                </div>
            </div>

            <!-- Confetti Container -->
            <div id="confettiContainer" class="fixed inset-0 pointer-events-none z-50"></div>

            <!-- Timeline -->
            <div class="timeline-container bg-white rounded-2xl md:rounded-3xl shadow-xl p-6 md:p-16 mb-6 md:mb-8"
                style="box-shadow: 0 10px 40px rgba(139, 69, 19, 0.15);">
                <h2 class="section-title text-xl md:text-2xl font-bold text-center mb-6 md:mb-8 text-amber-900">
                    ğŸ“œ Ø§Ù„Ø®Ø· Ø§Ù„Ø²Ù…Ù†ÙŠ
                </h2>
                <div class="relative overflow-x-auto">
                    <!-- Timeline line with arrow -->
                    <div class="relative flex items-center mb-32 md:mb-24 min-w-max px-4">
                        <div class="flex-1 h-1 rounded-full relative overflow-hidden"
                            style="background: linear-gradient(90deg, #8B4513 0%, #CD853F 50%, #DAA520 100%); min-width: 600px;">
                        </div>
                        <div class="w-0 h-0 border-t-8 border-t-transparent border-b-8 border-b-transparent border-r-12"
                            style="border-right-width: 14px; border-right-color: #DAA520;"></div>
                    </div>

                    <!-- Points and circles below -->
                    <div id="timeline"
                        class="flex justify-between items-start absolute top-0 left-4 right-20 min-w-max"
                        style="min-width: 600px;">
                        <!-- Will be generated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Available Events to Drag -->
            <div class="mb-8">
                <h2 class="section-title text-xl md:text-2xl font-bold text-center mb-6 text-amber-900">
                    ğŸ´ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="availableEvents">
                    <!-- Events will be generated by JavaScript -->
                </div>
            </div>
        </div>

        <script>
            const events = [
                { id: 1, text: "Ø¥ÙŠÙ…Ø§Ù† Ø§Ù„ÙØªÙŠØ© ÙÙŠ Ø¨ÙŠØ¦Ø© Ø´Ø±ÙƒÙŠØ©", order: 0 },
                { id: 2, text: "Ø§Ù„Ù‡Ø±ÙˆØ¨ Ø¥Ù„Ù‰ Ø§Ù„ÙƒÙ‡Ù", order: 1 },
                { id: 3, text: "Ø§Ù„Ù†ÙˆÙ… Ø§Ù„Ø¹Ù…ÙŠÙ‚", order: 2 },
                { id: 4, text: "Ø§Ù„Ø§Ø³ØªÙŠÙ‚Ø§Ø¸ ÙˆÙ…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡", order: 3 },
                { id: 5, text: "Ø§Ù†ØªØ´Ø§Ø± Ø§Ù„Ø®Ø¨Ø± ÙˆØ§Ù„Ù…Ø¹Ø¬Ø²Ø©", order: 4 },
                { id: 6, text: "Ù…ÙˆØªÙ‡Ù… Ù…Ø±Ø© Ø£Ø®Ø±Ù‰", order: 5 },
                { id: 7, text: "Ø§Ø®ØªÙ„Ø§Ù Ø§Ù„Ù†Ø§Ø³ ÙˆØ¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø³Ø¬Ø¯", order: 6 }
            ];

            let availableItems = [];
            let placedItems = [];
            let draggedElement = null;
            let isMobile = window.innerWidth < 768;

            function shuffleArray(array) {
                const arr = [...array];
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
                return arr;
            }

            function resetGame() {
                availableItems = shuffleArray(events);
                placedItems = new Array(events.length).fill(null);
                document.getElementById('successMessage').classList.add('hidden');
                document.getElementById('confettiContainer').innerHTML = '';
                renderTimeline();
                renderAvailableEvents();
            }

            function renderTimeline() {
                const timeline = document.getElementById('timeline');
                timeline.innerHTML = '';

                placedItems.forEach((item, idx) => {
                    const slot = document.createElement('div');
                    slot.className = 'flex flex-col items-center';
                    slot.style.width = `${600 / events.length}px`;

                    // Point on timeline
                    const point = document.createElement('div');
                    point.className = 'timeline-point w-3 h-3 md:w-4 md:h-4 rounded-full transition-all relative';

                    if (item) {
                        point.classList.add('filled');
                        point.style.background = 'linear-gradient(135deg, #DAA520 0%, #FFD700 100%)';
                        point.style.boxShadow = '0 0 15px rgba(218, 165, 32, 0.6)';

                        // Add sparkles
                        for (let i = 0; i < 4; i++) {
                            const sparkle = document.createElement('div');
                            sparkle.className = 'sparkle';
                            sparkle.style.top = `${Math.random() * 16 - 8}px`;
                            sparkle.style.left = `${Math.random() * 16 - 8}px`;
                            sparkle.style.animationDelay = `${i * 0.3}s`;
                            point.appendChild(sparkle);
                        }
                    } else {
                        point.style.backgroundColor = '#D3D3D3';
                        point.style.border = '2px solid #8B4513';
                    }

                    // Drop zone
                    const dropZone = document.createElement('div');
                    dropZone.className = 'w-20 h-16 md:w-28 md:h-14 rounded-xl mt-4 flex items-center justify-center border-2 border-dashed transition-all duration-300 cursor-pointer text-xs md:text-sm';

                    if (item) {
                        dropZone.style.background = 'linear-gradient(135deg, #FFF8DC 0%, #FFE4B5 100%)';
                        dropZone.style.borderColor = '#DAA520';
                        dropZone.style.borderStyle = 'solid';
                    } else {
                        dropZone.style.backgroundColor = '#F5F5F5';
                        dropZone.style.borderColor = '#A9A9A9';
                    }
                    dropZone.dataset.dropIndex = idx;
                    dropZone.addEventListener('dragover', handleDragOver);
                    dropZone.addEventListener('drop', handleDrop);
                    dropZone.addEventListener('dragenter', (e) => {
                        if (!item && draggedElement) {
                            dropZone.classList.add('drop-zone-hover');
                        }
                    });
                    dropZone.addEventListener('dragleave', (e) => {
                        dropZone.classList.remove('drop-zone-hover');
                    });

                    // Touch events for mobile
                    if (isMobile) {
                        dropZone.addEventListener('touchend', handleTouchDrop);
                    }

                    if (item) {
                        dropZone.draggable = true;
                        dropZone.dataset.fromTimeline = 'true';
                        dropZone.dataset.timelineIndex = idx;
                        dropZone.dataset.itemId = item.id;
                        dropZone.classList.add('cursor-move');
                        dropZone.addEventListener('dragstart', handleDragStart);
                        dropZone.addEventListener('dragend', (e) => {
                            e.currentTarget.classList.remove('dragging');
                        });
                        
                        if (isMobile) {
                            dropZone.addEventListener('touchstart', handleTouchStart);
                        }

                        dropZone.innerHTML = `
                            <div class="text-center px-2">
                                <div class="font-bold leading-tight" style="color: #8B4513;">${item.text}</div>
                            </div>
                        `;
                    }

                    slot.appendChild(point);
                    slot.appendChild(dropZone);
                    timeline.appendChild(slot);
                });
            }

            function renderAvailableEvents() {
                const container = document.getElementById('availableEvents');
                container.innerHTML = '';

                availableItems.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'event-card w-full h-20 md:h-16 rounded-xl flex items-center justify-center cursor-move transition-all duration-300';
                    card.style.backgroundColor = '#F5E6D3';
                    card.style.border = '3px solid #D2691E';
                    card.style.boxShadow = '0 4px 12px rgba(210, 105, 30, 0.2)';
                    card.draggable = true;
                    card.dataset.itemId = item.id;
                    card.dataset.fromTimeline = 'false';

                    // Adjust height for landscape
                    if (window.innerHeight < 500 && window.matchMedia("(orientation: landscape)").matches) {
                        card.style.height = '3.5rem';
                    }

                    card.innerHTML = `
                        <div class="text-center px-4">
                            <div class="text-sm md:text-base font-bold leading-tight" style="color: #8B4513;">${item.text}</div>
                        </div>
                    `;

                    card.addEventListener('dragstart', handleDragStart);
                    card.addEventListener('dragend', (e) => {
                        e.currentTarget.classList.remove('dragging');
                    });
                    
                    if (isMobile) {
                        card.addEventListener('touchstart', handleTouchStart);
                    }
                    
                    container.appendChild(card);
                });

                if (availableItems.length === 0) {
                    container.innerHTML = '<div class="col-span-full text-center text-lg py-6 w-full font-semibold" style="color: #8B4513;">âœ¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙÙŠ Ù…ÙƒØ§Ù†Ù‡Ø§!</div>';
                }
            }

            function handleDragStart(e) {
                draggedElement = e.currentTarget;
                e.currentTarget.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
            }

            function handleDragOver(e) {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            }

            function handleDrop(e) {
                e.preventDefault();
                e.currentTarget.classList.remove('drop-zone-hover');

                if (!draggedElement) return;

                const dropTarget = e.currentTarget;
                const dropIndex = parseInt(dropTarget.dataset.dropIndex);

                if (dropIndex === undefined || dropIndex === null) return;

                const itemId = parseInt(draggedElement.dataset.itemId);
                const fromTimeline = draggedElement.dataset.fromTimeline === 'true';

                const item = fromTimeline
                    ? placedItems[parseInt(draggedElement.dataset.timelineIndex)]
                    : availableItems.find(i => i.id === itemId);

                if (!item) return;

                if (fromTimeline) {
                    placedItems[parseInt(draggedElement.dataset.timelineIndex)] = null;
                } else {
                    availableItems = availableItems.filter(i => i.id !== itemId);
                }

                if (placedItems[dropIndex]) {
                    availableItems.push(placedItems[dropIndex]);
                }

                placedItems[dropIndex] = item;
                draggedElement.classList.remove('dragging');
                draggedElement = null;

                renderTimeline();
                renderAvailableEvents();
                checkCompletion();
            }

            // Touch event handlers for mobile
            let touchStartElement = null;

            function handleTouchStart(e) {
                touchStartElement = e.currentTarget;
                e.currentTarget.classList.add('dragging');
            }

            function handleTouchDrop(e) {
                e.preventDefault();
                
                if (!touchStartElement) return;

                const dropTarget = e.currentTarget;
                const dropIndex = parseInt(dropTarget.dataset.dropIndex);

                if (dropIndex === undefined || dropIndex === null) return;

                const itemId = parseInt(touchStartElement.dataset.itemId);
                const fromTimeline = touchStartElement.dataset.fromTimeline === 'true';

                const item = fromTimeline
                    ? placedItems[parseInt(touchStartElement.dataset.timelineIndex)]
                    : availableItems.find(i => i.id === itemId);

                if (!item) return;

                if (fromTimeline) {
                    placedItems[parseInt(touchStartElement.dataset.timelineIndex)] = null;
                } else {
                    availableItems = availableItems.filter(i => i.id !== itemId);
                }

                if (placedItems[dropIndex]) {
                    availableItems.push(placedItems[dropIndex]);
                }

                placedItems[dropIndex] = item;
                touchStartElement.classList.remove('dragging');
                touchStartElement = null;

                renderTimeline();
                renderAvailableEvents();
                checkCompletion();
            }

            function checkCompletion() {
                if (placedItems.every(item => item !== null)) {
                    const isCorrect = placedItems.every((item, idx) => item.order === idx);
                    if (isCorrect) {
                        setTimeout(() => showSuccess(), 300);
                    }
                }
            }

            function showSuccess() {
                document.getElementById('successMessage').classList.remove('hidden');
                createConfetti();
            }

            function createConfetti() {
                const container = document.getElementById('confettiContainer');
                container.innerHTML = '';

                const colors = ['#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#4B0082', '#9400D3', '#FF1493', '#00CED1', '#FFD700'];
                const shapes = ['â—', 'â– ', 'â–²', 'â˜…', 'â™¥', 'â—†'];

                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti absolute font-bold';
                    confetti.textContent = shapes[Math.floor(Math.random() * shapes.length)];
                    confetti.style.color = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.fontSize = (Math.random() * 20 + 14) + 'px';
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    container.appendChild(confetti);
                }

                setTimeout(() => {
                    container.innerHTML = '';
                }, 4000);
            }

            document.getElementById('resetBtn').addEventListener('click', resetGame);

            // Detect window resize
            window.addEventListener('resize', () => {
                isMobile = window.innerWidth < 768;
            });

            resetGame();
        </script>
    </div>
</body>

</html>
